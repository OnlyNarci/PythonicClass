# Pythonic 教程 - 第四课：类型注解-typing

## 一、typing模块的核心功能
typing 是 Python 标准库模块，核心作用是**补充和增强类型注解能力**，解决内置类型标注的局限性：
1. 支持更复杂的类型标注（如“可选类型”“多类型可选”“限定值范围”等）；
2. 让类型注解更精准、可读性更强，符合 Pythonic 「清晰、易协作」的原则。

使用前需先导入：
```python
from typing import List, Dict, Union, Optional, Literal  # 按需导入
```

## 二、用typing重构复杂类型标注
上节课用内置 `list/dict` 实现的复合类型标注，可通过 typing 模块的 `List/Dict` 重构（语法逻辑一致，兼容性更强）：

### 原内置类型标注
```python
# 列表嵌套字典
user_list: list[dict[str, str]] = [{"name": "张三", "phone": "13800138000"}]
# 字典嵌套列表
score_dict: dict[str, list[float]] = {"math": [90.5, 88.0]}
```

### typing模块重构后
```python
from typing import List, Dict

# List替代list，Dict替代dict
user_list: List[Dict[str, str]] = [{"name": "张三", "phone": "13800138000"}]
score_dict: Dict[str, List[float]] = {"math": [90.5, 88.0]}
```

## 三、typing的特殊标注方法
### 1. Union：标注“多类型可选”
作用：指定变量/参数可以是多种类型中的一种。
语法：`Union[类型1, 类型2, ...]`
示例：
```python
from typing import Union

# 变量可以是int或str类型
user_id: Union[int, str] = 1001
user_id = "u1001"  # 也符合注解要求

# 函数参数支持int/float，返回值支持int/float
def calculate(num: Union[int, float]) -> Union[int, float]:
    return num * 2
```

### 2. Optional：标注“可选类型（允许None）”
作用：等价于 `Union[类型, None]`，简化“允许为 None”的标注。
语法：`Optional[类型]`
示例：
```python
from typing import Optional

# 可选的手机号：可以是字符串，也可以是None
phone: Optional[str] = None
phone = "13900139000"  # 符合注解要求

# 函数参数允许为None
def set_phone(phone: Optional[str]) -> None:
    print(phone)
```

### 3. Literal：标注“限定值范围”
作用：限制变量/参数只能是指定的固定值之一。
语法：`Literal["值1", "值2", ...]`
示例：
```python
from typing import Literal

# 性别只能是"male"或"female"
gender: Literal["male", "female"] = "male"
gender = "female"  # 符合要求
# gender = "other"  # 不符合注解限定

# 函数参数限定值范围
def set_gender(gender: Literal["male", "female"]) -> None:
    print(f"性别：{gender}")
```

## 四、常用typing类型速查表（1分钟）
| typing类型 | 注解写法                | 核心说明                     |
|------------|-------------------------|------------------------------|
| List       | List[元素类型]          | 列表，替代内置list[]         |
| Dict       | Dict[键类型, 值类型]    | 字典，替代内置dict[]         |
| Tuple      | Tuple[类型1, 类型2]     | 元组（固定元素类型/数量）    |
| Set        | Set[元素类型]           | 集合，替代内置set[]          |
| Union      | Union[类型1, 类型2]     | 多类型可选                   |
| Optional   | Optional[类型]          | 可选类型（允许为None）       |
| Literal    | Literal["值1", "值2"]   | 限定值范围                   |
| Callable   | Callable[[参数类型], 返回值类型] | 可调用对象（如函数）|
| Iterable   | Iterable[元素类型]      | 可遍历对象（如列表、生成器） |
| Any        | Any                     | 任意类型（关闭类型检查）     |

示例（Callable标注函数）：
```python
from typing import Callable

# 标注：参数为两个int，返回值为int的函数
def add(a: int, b: int) -> int:
    return a + b

# 变量func是符合上述规范的可调用对象
func: Callable[[int, int], int] = add
```

## 五、小结
1. typing 模块增强类型注解能力，解决内置类型标注局限性；
2. List/Dict 可替代内置 list/dict 实现兼容型复合标注；
3. Union（多类型）、Optional（可选None）、Literal（限定值）是高频特殊标注；


## 下一课：TypeAlias & Context
